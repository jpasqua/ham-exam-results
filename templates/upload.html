{% extends "base.html" %}
{% block pagetitle %}WM7X Results Helper{% endblock %}
{% block content %}
<h1>Help Reviewing Exam Results</h1>

{% if error %}
<p style="color:red;">{{ error }}</p>
{% endif %}


<form method="post" enctype="multipart/form-data">
  <div>
    <!-- Hidden file input -->
    <input type="file" id="pdf_file" name="pdf_file" accept=".pdf,application/pdf" class="file-input">
    <!-- Styled label as button -->
    <label for="pdf_file" class="button">Choose Exam PDF</label>
    <!-- File name display -->
    <span id="file-name">No exam selected yet</span>
  </div>
  <div style="margin-top: 10px;">
    <input type="submit" value="Process Results" class="button">
  </div>
</form>

<!-- Collapsible help section -->
<details class="help-section" style="margin-top: 30px;">
  <summary>Need Help?</summary>
  <ol>
    <li>
      In the ExamTools session, click on the applicant to reveal the controls.
    </li>
    <li>
      Click "Print Forms" to reveal a drop-down menu.
      <img src="{{ url_for('static', filename='images/help-step1.png') }}" alt="Step 1: ExamTools page" style="max-width: 100%; margin-top: 10px;">
    </li>
    <li>
      Click "Results" to download the Results PDF.
      <img src="{{ url_for('static', filename='images/help-step2.png') }}" alt="Step 2: Download button" style="max-width: 100%; margin-top: 10px;">
    </li>
    <li>
      Click "Choose Exam PDF" above to upload it.
    </li>
    <li>
      Click "Process Results" to generate a report.
    </li>
  </ol>
  <p style="font-size: 0.9em; color: #555; margin-top: 10px;">
    ðŸ”’ Note: Uploaded files are deleted immediately after processing.
  </p>
</details>

<!-- JS to display selected file name -->
<script>
document.getElementById('pdf_file').addEventListener('change', function() {
    const fileNameSpan = document.getElementById('file-name');
    if (this.files.length > 0) {
        fileNameSpan.textContent = this.files[0].name;
    } else {
        fileNameSpan.textContent = 'No exam selected';
    }
});
</script>

{% endblock %}